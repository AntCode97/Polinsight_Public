<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<th:block th:include="admin/layout/sidebar"></th:block>
<head>
    <meta charset="UTF-8">
    <style type="text/css">
        .admin_main_contents {
            padding: 20px 40px;
        }
        .main_item {
            color: #000;
            font-size: 3rem;
            font-weight: bold;
            padding: 10px 0 20px;
            border-bottom: 1px dashed #dadada;
        }
        .admin_main_contents_item > a{
            background-color: #FFF;
            border: 1px solid #DDD;
            font-size: 1rem;
            padding: 10px 20px;
            border-radius: 5px;
            padding: 10px 20px;
            display: inline-block;
            cursor: pointer;
            box-shadow: 0 2px 2px 0 hsl(0deg 0% 60% / 14%), 0 3px 1px -2px hsl(0deg 0% 60% / 20%), 0 1px 5px 0 hsl(0deg 0% 60% / 12%);
            transition: 0.2s linear;
        }
        .admin_main_contents_item > a:hover { box-shadow: none; }
        .main_contents_wrap {
            margin: 40px 0;
        }
        .board-search {
            display: inline-block;
            width: 100%;
            margin-bottom: 41px;
        }
        .board-search .util-search {
            color: #333;
            font-size: 1.6rem;
            margin-bottom: 20px;
        }
        .board-search .form-search {
            background-color: #EEE;
            padding: 20px;
            box-shadow: 0 2px 2px 0 hsl(0deg 0% 60% / 14%), 0 3px 1px -2px hsl(0deg 0% 60% / 20%), 0 1px 5px 0 hsl(0deg 0% 60% / 12%);
        }
        .board-search .tbl-search { text-align: center; }
        .board-search .box-search {
            position: relative;
            display: inline-block;
            vertical-align: middle;
            background-color: white;
            height: 55px;
            line-height: 55px;
            border: 1px solid #ccd0d7;
            min-width: 600px;
        }
        .board-search .box-search input {
            position: relative;
            top: -1px;
            width: 100%;
            height: 100%;
            border: 0;
            background-color: transparent;
            font-size: 1.6rem;
            text-indent: 10px;
            padding-right: 55px;
        }
        .board-search .box-search input[type="submit"] {
            position: absolute;
            right: 0;
            top: 0;
            width: 50px;
            height: 55px;
            background-image: url('/img/etc/ico-search-btn.png');
            background-repeat: no-repeat;
            background-position: center;
            text-indent: -9999px;
            cursor: pointer;
        }
        .board-th {
            border-top: 2px solid #7c7c7c;
            background-color: #f2f2f2!important;
        }
        .board-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #cfcfd1;
            background-color: #FFF;
        }
        .board-row > * {
            padding: 9px 10px;
            display: inline-block;
            font-size: 1.6rem;
            line-height: 30px;
            color: #666;
            text-align: center;
        }
        .board-row > *:nth-child(1){ width: 70px; }
        .board-row > *:nth-child(2){ width: 500px; }
        .board-row > *:nth-child(3){ width: 100px; }
        .board-row > *:nth-child(4){ width: 130px; }
        .board-row > *:nth-child(5){ width: 80px; }
        .board-row > *:nth-child(6){ width: 95px; }
        .board-row > *:nth-child(7){ width: 120px; }

        .btn_udel {
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
        }
        .board-row > span > button:first-child {
            margin-right: 3px;
        }
        .board-title { text-align: left!important; }
        .board-bottom {
            text-align: right;
            padding: 10px;
        }
        .page-button {
            text-align: center;
            margin: 20px 0;
        }
        .page-button > a {
            text-align: center;
            display: inline-block;
            font-size: 1.5rem;
            width: 30px;
            line-height: 34px;
            border: 1px solid #e2e2e2;
            cursor: pointer;
        }
        .active {
            color: white;
            background-color: #444;
            border: 1px solid #006;
        }
        .file_icon_no {
            color: #ddd;
        }
        .file_icon_yes {
            color: black;
        }
    </style>
</head>
<body style="margin-left: 260px; margin-top: 51px; background-color: #fafafa; ">
    <div class="admin_main_contents">
        <div class="admin_main_contents_category">
            <div class="admin_main_contents_item">
                <p class="main_item">공지사항</p>
            </div>
        </div>

        <div class="main_contents_wrap">
            <div class="board-search">
                <div class="util-search">총 <strong th:text="${boards.getTotalElements()}"></strong>개의 게시물이 있습니다.</div>
                <div class="form-search">
                    <div class="tbl-search">
                        <div class="box-search">
                            <input type="text" id="searchinput"/>
                            <input type="submit"  />
                        </div>
                    </div>
                </div>
            </div>

            <div class="scroll-table">
                <div class="board-th board-row">
                    <span>번호</span>
                    <a href="#">제목</a>
                    <span>작성자</span>
                    <span>작성일</span>
                    <span>조회수</span>
                    <span>첨부파일</span>
                    <span>수정/삭제</span>
                </div>

                <!-- 게시글이 0건인 경우 -->
                <div class="board-row" th:if="${boards.getTotalElements() == 0}">
                    <span >1</span>
                    <a class="board-title"><strong>등록된 게시글이 없습니다.</strong></a>
                    <span>관리자</span>
                    <span th:text="${#calendars.format(#calendars.createNow, 'yyyy-MM-dd')}"></span>
                    <span>0</span>
                    <span>
                        <i class="fas fa-paperclip file_icon_no"></i>
                    </span>
                    <span></span>
                </div>

                <!-- 게시글 전체 조회 출력 -->
                <div th:replace="fragments/boardList :: #boardTable" >
<!--                    <div id="boardTable" >-->
<!--                <div class="board-row" th:each="list : ${boards}">-->
<!--                    <span th:text="${list.id}"></span>-->
<!--                    <a th:href="@{/admin2/boards/{id} (id=${list.id})}" class="board-title"><strong th:text="${list.title}"></strong></a>-->
<!--                    <span th:if="${list.newBoard}">-->
<!--                                 New!-->
<!--                            </span>-->
<!--                    <span th:text="${list.user.name}"></span>-->
<!--                    <span th:text="${#temporals.format(list.registeredAt, 'yyyy-MM-dd')}"></span>-->

<!--                    <span th:text="${list.viewcnt}"></span>-->
<!--                    <span>-->
<!--                        <i th:if="${list.attaches.size() == 0}" class="fas fa-paperclip file_icon_no"></i>-->
<!--                        <i th:unless="${list.attaches.size() == 0}" class="fas fa-paperclip file_icon_yes"></i>-->
<!--                    </span>-->
<!--                    <span><button class="btn_udel btn-support" th:onclick="|location.href='@{/admin2/boards/{id}/edit (id=${list.id})}'|">수정</button>-->
<!--                        <button class="btn_udel btn-warn" th:onclick="|location.href='@{/admin2/boards/{id}/delete (id=${list.id})}'|">삭제</button></span>-->
<!--                </div>-->
<!--                <div class="board-bottom"><button class="btn_udel btn-green" onclick="location.href='/admin2/boards/new'">새 글쓰기</button></div>-->
<!--                </div>-->
            </div>

            <!-- 페이지네이션 -->
            <div class="page-button" th:with="start=${T(Math).floor(boards.number/10)*10 + 1}, last=(${start + 9 < boards.totalPages ? start + 9 : boards.totalPages})">
<!--                 <a th:href="@{/boards(page=1)}" aria-label="First">-->
<!--                    <span aria-hidden="true"><img class="button" src="/img/board/first_page.png" alt="처음 페이지로 이동"></span>-->
<!--                </a>-->

                 <a th:class="${boards.first} ? 'disabled'"th:href="${boards.first} ? '#' : @{'/admin2/boards/' + ${type}(page=${boards.number})}" aria-label="Previous">
                     <i class="fas fa-angle-double-left"></i>
                </a>

<!--                <a th:unless="${page == 0}" class="current-page" th:each="page: ${#numbers.sequence(start, last)}" th:class="${page == boards.number + 1} ? 'active': 'not-active' " th:text="${page}"-->
<!--                   th:href="@{'/admin/boards/' + ${type}(page=${page})}"></a>-->
                <a th:if="${boardSearch.getBoardType()} !=null" th:unless="${page == 0}" class="current-page" th:each="page: ${#numbers.sequence(start, last)}" th:class="${page == boards.number + 1} ? 'active': 'not-active' " th:text="${page}"
                   th:href="@{/admin2/boards/search(page=${page}-1, boardType=${boardSearch.boardType}, searchType=${boardSearch.searchType},searchValue=${boardSearch.searchValue})}"></a>
                <a th:if="${boardSearch.getBoardType()} ==null" th:unless="${page == 0}" class="current-page" th:each="page: ${#numbers.sequence(start, last)}" th:class="${page == boards.number + 1} ? 'active': 'not-active' " th:text="${page}"
                   th:href="@{/amdin2/boards(page=${page})}"></a>

                <a th:class="${boards.last} ? 'disabled'" th:href="${boards.last} ? '#' : @{'/admin2/boards/' + ${type}(page=${boards.number + 2})}" aria-label="Next">
                    <i class="fas fa-angle-double-right"></i>
                </a>

<!--                 <a th:href="@{/boards(page=${boards.totalPages})}" aria-label="Last">-->
<!--                    <img class="button" src="/img/board/last_page.png" alt="마지막 페이지로 이동">-->
<!--                </a> -->
            </div>
        </div>
    </div>
</body>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
    const asyncFindBoard = (e) => {
        e.preventDefault();
        e.returnValue = false;
        const keyword = $("#searchinput").val()

        // console.log('/api/board/search?type=' + searchType + '&cassify=' + classify + '&keyword=' + keyword)
        console.log(keyword);
        // axios.get('/api/admin2/board/search?keyword=' + keyword)
        //     .then(function (fragment){
        //         $('#boardTable').replaceWith(fragment);
        //     })
        //     .catch(err => {
        //         console.log(err)
        //     })
        $.ajax({
            url: '/api/admin2/board/search?keyword=' + keyword,
            type: "POST",
            data: keyword,
        }).done(function (fragment) {
                console.log(fragment)
                $('#boardTable').replaceWith(fragment);
            });
    }

    $(function () {
      $("#searchinput").on('change keyup', asyncFindBoard)
    })
    window.onload = function (){
        const keyword = document.getElementById("searchinput");

        console.log(keyword);
        keyword.onchange(asyncFindBoard);
    }

</script>
</html>
